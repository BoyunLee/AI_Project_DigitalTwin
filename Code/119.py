import folium
import folium as g
import webbrowser
import base64
import pandas as pd

#기준이 되는 map 설정 및 크기 설정
m = folium.Map(location=[37.567418,126.967106],
               zoom_start=11,
               tiles = "CartoDB dark_matter")

latlon2 =[
    ['관악소방서', 37.47394276, 126.9523549],
    ['영동119안전센터', 37.5221434, 127.0369439],
    ['관악119안전센터', 37.47401511, 126.9523479],
    ['시흥119안전센터', 37.44858657, 126.9005122],
    ['방배119안전센터', 37.47551792, 126.9882097],
    ['잠원119안전센터', 37.49906978, 127.0116318],
    ['구조대', 37.47385906, 126.9523758],
    ["난곡119안전센터",38.3793779,126.9129458],
    ['독산119안전센터',38.37160382,126.8948447],
    ['신영119안전센터',38.50944793,126.9582345],
    ['서초소방서',38.40210096,   126.9897427],
    ['여의도119안전센터',38.42091151,126.9250201],
    ['서빙고119안전센터',38.42450659,126.992859],
    ['반포119안전센터',38.40210173,126.9896249],
    ['구조대',38.40209456,126.9898619],
    ['구로소방서',38.40147512,126.8614158],
    ['수궁119안전센터',38.39995486,126.825356],
    ['고일119안전센터',38.40154482,126.8615246],
    ['고척119안전센터',38.40859017,126.8510018],
    ['신도림119안전센터',38.41105364,126.8776479],
    ['대림119안전센터',38.40100916,126.9007555],
    ['구로119안전센터',38.39786667,126.8790065],
    ['구조대',38.4014019,126.8613202],
    ['진관119안전센터',38.53263673,126.9166925],
    ['목동119안전센터',38.44645665,126.8800295],
    ['신정119안전센터',38.42547951,126.8469984],
    ['우면119안전센터',38.38431196,127.0220287],
    ['양재119안전센터',38.37313492,127.0392403],
    ['역삼119안전센터',38.40083895,127.0408548],
    ['개포119안전센터',38.37836211,127.0483893],
    ['수서119안전센터',38.38859089,127.0918857],
    ['잠실119안전센터',38.41099248,127.0929465],
    ['마포소방서',38.4530529,126.9302456],
    ['신수119안전센터',38.45312255,126.9302527],
    ['홍은119안전센터',38.50237605,126.9443083],
    ['구조대',38.45299589,126.9302423],
    ['서교119안전센터', 38.45398058, 126.9123684],
    ['역촌119안전센터', 38.50865582, 126.9074428],
    ['북가좌119안전센터', 38.48651142, 126.9098113],
    ['수색119안전센터', 38.48889299, 126.8864542],
    ['신교119안전센터', 38.48794838, 126.967577],
    ['마천119안전센터', 38.40337759, 127.1421753],
    ['구조대', 38.40360312, 127.1423027],
    ['중랑소방서', 38.51901499, 127.0939167],
    ['신내119안전센터', 38.51897466, 127.0940558],
    ['구조대', 38.51906548, 127.0937918],
    ['길동119안전센터', 38.44462552, 127.1440467],
    ['용두119안전센터', 38.48152688, 127.0300231],
    ['숭인119안전센터', 38.48142817, 127.0199343],
    ['동대문소방서', 38.4676759, 127.0653709],
    ['이태원119안전센터', 38.43806022, 126.9936533],
    ['구조대', 38.47648619, 126.9765447],
    ['북아현119안전센터', 38.4643451, 126.9530958],
    ['회현119안전센터', 38.46186694, 126.9810228],
    ['충무로119안전센터', 38.46581901, 126.9907595],
    ['후암119안전센터', 38.45258248, 126.9754793],
    ['여의도수난구조대', 38.43821573, 126.9175148],
    ['방화119안전센터', 38.48346221, 126.8098927],
    ['화곡119안전센터', 38.44732051, 126.8412128],
    ['양천119안전센터', 38.43385255, 126.8684012],
    ['강서소방서', 38.46169689, 126.8564421],
    ['등촌119안전센터', 38.46171514, 126.8564027],
    ['구조대', 38.46167699, 126.8564917],
    ['구조대', 38.43381757, 126.8687573],
    ['소방항공대', 38.45823618, 126.7826922],
    ['신월119안전센터', 38.43159971, 126.8289681],
    ['상도119안전센터', 38.40268709, 126.9265212],
    ['신길119안전센터', 38.4140858, 126.9191119],
    ['신림119안전센터', 38.39334618, 126.920943],
    ['노량진119안전센터', 38.41733984, 126.9441873],
    ['백운119안전센터', 38.3984797, 126.9590162],
    ['연건119안전센터', 38.48308184, 126.9997861],
    ['은평소방서', 38.53256971, 126.9166855],
    ['월계119안전센터', 38.53246136, 127.0549981],
    ['하계119안전센터', 38.54185097, 127.0698671],
    ['방학119안전센터', 38.56759886, 127.0414462],
    ['구조대', 38.56779758, 127.0414763],
    ['구조대', 38.54169049, 127.0699385],
    ['소방항공대', 38.45823618, 126.7826922],
    ['신월119안전센터', 38.43159971, 126.8289681],
    ['상도119안전센터', 38.40268709, 126.9265212],
    ['신길119안전센터', 38.4140858, 126.9191119],
    ['신림119안전센터', 38.39334618, 126.920943],
    ['노량진119안전센터', 38.41733984, 126.9441873],
    ['백운119안전센터', 38.3984797, 126.9590162],
    ['연건119안전센터', 38.48308184, 126.9997861],
    ['은평소방서', 38.53256971, 126.9166855],
    ['월계119안전센터', 38.53246136, 127.0549981],
    ['하계119안전센터', 38.54185097, 127.0698671],
    ['방학119안전센터', 38.56759886, 127.0414462],
    ['구조대', 38.56779758, 127.0414763],
    ['구조대', 38.54169049, 127.0699385],
    ['119특수구조대', 38.53733906, 126.9112829],
    ['창동119안전센터', 38.55041036, 127.0421763],
    ['송파소방서', 38.40347648, 127.1422376],
    ['방이119안전센터', 38.42346281, 127.1361828],
    ['장안119안전센터', 38.46773703, 127.0654313],
    ['전농119안전센터', 38.47998756, 127.0444469],
    ['돈암119안전센터', 38.49463346, 127.0125093],
    ['구조대', 38.46760872, 127.0653132],
    ['중부소방서', 38.46853753, 127.0134763],
    ['무학119안전센터', 38.46846877, 127.0134674],
    ['구조대', 38.46861241, 127.0134792],
    ['을지로119안전센터', 38.47038697, 127.0101233],
    ['신당119안전센터', 38.45660025, 127.0076454],
    ['천호119안전센터', 38.44227519, 127.1308857],
    ['수락119안전센터', 38.58334954, 127.0543179],
    ['공릉119안전센터', 38.52273608, 127.0796125],
    ['종암119안전센터', 38.50618375, 127.0298966],
    ['구조대', 38.50601536, 127.0301824],
    ['성북소방서', 38.50609868, 127.0300363],
    ['청량리119안전센터', 38.49080983, 127.0509105],
    ['삼각산119안전센터', 38.52352458, 127.0135439],
    ['개화119안전센터', 38.47871012, 126.7985542],
    ['119구조대', 38.47548653, 126.9316565],
    ['서대문소방서', 38.4769302, 126.9330004],
    ['용산소방서', 38.43775306, 126.9690663],
    ['한강로119안전센터', 38.43767978, 126.9689773],
    ['구조대', 38.43782865, 126.9691745],
    ['동작소방서', 38.39830293, 126.9145535],
    ['동작119안전센터', 38.39830045, 126.9144077],
    ['구조대', 38.39830379, 126.9146854],
    ['종합운동장119안전센터', 38.41789191, 127.0697479],
    ['휘경119안전센터', 38.4943343, 127.0638308],
    ['신트리119안전센터', 38.41432277, 126.8440009],
    ['상암119안전센터', 38.48357554, 126.8776717],
    ['이촌119안전센터', 38.43371519, 126.9506997],
    ['양천소방서', 38.43383239, 126.8685724],
    ['북한산산악구조대', 38.54414109, 126.9404743],
    ['반포수난구조대', 38.40996253, 126.9769977],
    ['도봉산산악구조대', 38.59216582, 127.0331716],
    ['관악산산악구조대', 38.36096371, 126.9421649],
    ['성수119안전센터', 38.440859, 127.0593113],
    ['중곡119안전센터', 38.47061629, 127.085597],
    ['왕십리119안전센터', 38.46570539, 127.0338218],
    ['금호119안전센터', 38.4577243, 127.022539],
    ['구조대', 38.45744208, 127.0379692],
    ['행당119안전센터', 38.45728054, 127.0377442],
    ['성동소방서', 38.45733558, 127.0378862],
    ['능동119안전센터', 38.45533194, 127.0757919],
    ['뚝섬수난구조대', 38.43498701, 127.0592254],
    ['광진소방서', 38.44850391, 127.0816608],
    ['구조대', 38.44848829, 127.0817297],
    ['구의119안전센터', 38.44852448, 127.0815798],
    ['세곡119안전센터', 38.37412887, 127.1064564],
    ['본부현장대응단', 38.46253308, 126.986912],
    ['마곡119안전센터', 38.45959925, 126.8163918],
    ['강일119안전센터', 38.46101002, 127.1797864],
    ['광나루수난구조대', 38.44859548, 127.1170273],
    ['쌍문119안전센터', 38.55185831, 127.0250526],
    ['강북소방서', 38.53670276, 127.036564],
    ['번동119안전센터', 38.53675162, 127.0365285],
    ['구조대', 38.53665358, 127.0366053],
    ['공덕119안전센터', 38.45373683, 126.9571597],
    ['종로119안전센터', 38.47491085, 126.9900372],
    ['종로소방서', 38.47652979, 126.976534],
    ['세종로119안전센터', 38.47658427, 126.9765514],
    ['녹번119안전센터', 38.50478318, 126.9320099],
    ['119구조대', 38.53248904, 126.91669],
    ['봉천119안전센터', 38.38966261, 126.9386472],
    ['가락119안전센터', 38.40015467, 127.1127587],
    ['염리119안전센터', 38.44536895, 126.9427635],
    ['공단119안전센터', 38.38790072, 126.8951217],
    ['영등포소방서', 38.42216455, 126.9008616],
    ['영등포119안전센터', 38.42204441, 126.9008884],
    ['구조대', 38.42208346, 126.9009191],
    ['강남소방서', 38.41396363, 127.065496],
    ['구조대', 38.41392318, 127.0654276],
    ['삼성119안전센터', 38.41399062, 127.0656333],
    ['발산119안전센터', 38.45891613, 126.8327766],
    ['당산119안전센터', 38.43916854, 126.8958597],
    ['서초119안전센터', 38.39174025, 127.0258088],
    ['연희119안전센터', 38.47682007, 126.9330783],
    ['성산119안전센터', 38.47426763, 126.899799],
    ['강동소방서', 38.43294648, 127.1243687],
    ['면목119안전센터', 38.47651625, 127.0787427],
    ['망우119안전센터', 38.50148503, 127.0997055],
    ['거여119안전센터', 38.3977905, 127.1515543],
    ['성내119안전센터', 38.43296819, 127.1243089],
    ['고덕119안전센터', 38.4608317, 127.1518018],
    ['암사119안전센터', 38.45765044, 127.1281209],
    ['구조대', 38.43291575, 127.1244445],
    ['도봉119안전센터', 38.59121843, 127.0393022],
    ['중화119안전센터', 38.50413846, 127.0781877],
    ['길음119안전센터', 38.50649925, 127.0172637],
    ['장위119안전센터', 38.5192712, 127.0568294],
    ['우이119안전센터', 38.54455003, 127.0146571],
    ['미아119안전센터', 38.52368597, 127.0265645],
    ['노원소방서', 38.54177372, 127.0699054],
    ['도봉소방서', 38.56769136, 127.0414599],
    ['상계119안전센터', 38.55870004, 127.0704396]
]

for i in range(len(latlon2)):
     folium.Marker([latlon2[i][1],latlon2[i][2]],
                   icon=folium.Icon(color='red', icon='fire'),
                   popup = latlon2[i][0],
                   tooltip="소방서").add_to(m)
     
# SQLite3 데이터베이스 연결
df = pd.read_excel("C:\\project1\\응급실_목록_서울.xlsx")

for i in range(df.shape[0]):
    folium.Marker([df.iloc[i]['위도'], df.iloc[i]['경도']], # 위도, 경도
                  popup = f'<strong>{df.iloc[i]["병원명"]}</strong>',
                  icon=folium.Icon(color='green', icon='plus'),#마우스 클릭시 표기되는 문구
                  tooltip="click").add_to(m)

     

#webbrowser 활성화
m.save('filename.html')
webbrowser.open_new_tab('filename.html')